{"version":3,"file":"getData.js","names":["createGetDataForPreload","codeSplit","server","onError","getLocale","getConvertedRoutes","getCookie","params","context","dispatch","getState","window","_ReactPages_Page_SkipDataLoad","_ReactPages_Page_SkipDataLoad_on_navigation","_ReactPages_Page_HotReloadInProgress","getLocations","location","previousLocation","isInitialClientSideNavigation","shouldSkipPreloadForNavigation","preload","undefined","routes","getMatchedRoutes","routeIndices","getMatchedRoutesIndices","routeParams","getMatchedRoutesParams","getRouteParams","then","result","error","RedirectException","path","pathname","url","getLocationUrl","redirect","to","state","getCurrentlyMatchedLocation","_ReactPages_RouterHasFinishedInitialRender","getPreviouslyMatchedLocation"],"sources":["../../../lib/redux/preload/getData.js"],"sourcesContent":["import getLocationUrl from '../../getLocationUrl.js'\r\n\r\nimport {\r\n\tredirect,\r\n\tgetMatchedRoutes,\r\n\tgetMatchedRoutesIndices,\r\n\tgetMatchedRoutesParams,\r\n\tgetRouteParams,\r\n\tgetCurrentlyMatchedLocation,\r\n\tgetPreviouslyMatchedLocation,\r\n\tRedirectException\r\n} from '../../router/index.js'\r\n\r\nimport shouldSkipPreloadForNavigation from './shouldSkipPreloadForNavigation.js'\r\nimport preload from './preload.js'\r\n\r\nexport default function createGetDataForPreload(codeSplit, server, onError, getLocale, getConvertedRoutes, getCookie) {\r\n\treturn function({ params, context: { dispatch, getState } }) {\r\n\t\tif (!server) {\r\n\t\t\tif (window._ReactPages_Page_SkipDataLoad ||\r\n\t\t\t\twindow._ReactPages_Page_SkipDataLoad_on_navigation ||\r\n\t\t\t\twindow._ReactPages_Page_HotReloadInProgress) {\r\n\t\t\t\t// Reset \"skip `load`\" flag for `pushLocation()` and `replaceLocation()`.\r\n\t\t\t\tif (window._ReactPages_Page_SkipDataLoad_on_navigation) {\r\n\t\t\t\t\twindow._ReactPages_Page_SkipDataLoad_on_navigation = false;\r\n\t\t\t\t}\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst { location, previousLocation } = getLocations(getState())\r\n\t\tconst isInitialClientSideNavigation = !server && !previousLocation\r\n\t\t// A workaround for `found` router bug:\r\n\t\t// https://github.com/4Catalyzer/found/issues/239\r\n\t\t// Prevent executing `load`s on \"anchor\" link click.\r\n\t\tif (!server && !isInitialClientSideNavigation) {\r\n\t\t\tif (shouldSkipPreloadForNavigation(previousLocation, location)) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Execute `load`s.\r\n\t\treturn preload(\r\n\t\t\tlocation,\r\n\t\t\tisInitialClientSideNavigation ? undefined : previousLocation,\r\n\t\t\t{\r\n\t\t\t\troutes: getMatchedRoutes(getState(), getConvertedRoutes()),\r\n\t\t\t\trouteIndices: getMatchedRoutesIndices(getState()),\r\n\t\t\t\trouteParams: getMatchedRoutesParams(getState()),\r\n\t\t\t\tparams: getRouteParams(getState())\r\n\t\t\t},\r\n\t\t\tcodeSplit,\r\n\t\t\tserver,\r\n\t\t\tgetCookie,\r\n\t\t\tgetLocale,\r\n\t\t\tdispatch,\r\n\t\t\tgetState\r\n\t\t)\r\n\t\t.then(\r\n\t\t\t(result) => result,\r\n\t\t\t(error) => {\r\n\t\t\t\t// Possibly handle the error (for example, redirect to an error page).\r\n\t\t\t\tif (!(error instanceof RedirectException)) {\r\n\t\t\t\t\tif (onError) {\r\n\t\t\t\t\t\tonError(error, {\r\n\t\t\t\t\t\t\tpath : location.pathname,\r\n\t\t\t\t\t\t\turl  : getLocationUrl(location),\r\n\t\t\t\t\t\t\t// Using `redirect` instead of `goto` here\r\n\t\t\t\t\t\t\t// so that the user can't go \"Back\" to the page being preloaded\r\n\t\t\t\t\t\t\t// in case of an error because it would be in inconsistent state\r\n\t\t\t\t\t\t\t// due to `load` being interrupted.\r\n\t\t\t\t\t\t\tredirect(to) {\r\n\t\t\t\t\t\t\t\t// `to` can be a `string`.\r\n\t\t\t\t\t\t\t\tthrow new RedirectException(to)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tdispatch,\r\n\t\t\t\t\t\t\tgetState,\r\n\t\t\t\t\t\t\tserver\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthrow error\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n}\r\n\r\nfunction getLocations(state) {\r\n\tconst server = typeof window === 'undefined'\r\n\treturn {\r\n\t\tlocation: getCurrentlyMatchedLocation(state),\r\n\t\tpreviousLocation: (server || !window._ReactPages_RouterHasFinishedInitialRender) ? undefined : getPreviouslyMatchedLocation(state)\r\n\t}\r\n}"],"mappings":";;;;;;AAAA;AAEA;AAWA;AACA;AAAkC;AAEnB,SAASA,uBAAuB,CAACC,SAAS,EAAEC,MAAM,EAAEC,OAAO,EAAEC,SAAS,EAAEC,kBAAkB,EAAEC,SAAS,EAAE;EACrH,OAAO,gBAAsD;IAAA,IAA3CC,MAAM,QAANA,MAAM;MAAA,oBAAEC,OAAO;MAAIC,QAAQ,gBAARA,QAAQ;MAAEC,QAAQ,gBAARA,QAAQ;IACtD,IAAI,CAACR,MAAM,EAAE;MACZ,IAAIS,MAAM,CAACC,6BAA6B,IACvCD,MAAM,CAACE,2CAA2C,IAClDF,MAAM,CAACG,oCAAoC,EAAE;QAC7C;QACA,IAAIH,MAAM,CAACE,2CAA2C,EAAE;UACvDF,MAAM,CAACE,2CAA2C,GAAG,KAAK;QAC3D;QACA;MACD;IACD;IACA,oBAAuCE,YAAY,CAACL,QAAQ,EAAE,CAAC;MAAvDM,QAAQ,iBAARA,QAAQ;MAAEC,gBAAgB,iBAAhBA,gBAAgB;IAClC,IAAMC,6BAA6B,GAAG,CAAChB,MAAM,IAAI,CAACe,gBAAgB;IAClE;IACA;IACA;IACA,IAAI,CAACf,MAAM,IAAI,CAACgB,6BAA6B,EAAE;MAC9C,IAAI,IAAAC,0CAA8B,EAACF,gBAAgB,EAAED,QAAQ,CAAC,EAAE;QAC/D;MACD;IACD;IACA;IACA,OAAO,IAAAI,mBAAO,EACbJ,QAAQ,EACRE,6BAA6B,GAAGG,SAAS,GAAGJ,gBAAgB,EAC5D;MACCK,MAAM,EAAE,IAAAC,uBAAgB,EAACb,QAAQ,EAAE,EAAEL,kBAAkB,EAAE,CAAC;MAC1DmB,YAAY,EAAE,IAAAC,8BAAuB,EAACf,QAAQ,EAAE,CAAC;MACjDgB,WAAW,EAAE,IAAAC,6BAAsB,EAACjB,QAAQ,EAAE,CAAC;MAC/CH,MAAM,EAAE,IAAAqB,qBAAc,EAAClB,QAAQ,EAAE;IAClC,CAAC,EACDT,SAAS,EACTC,MAAM,EACNI,SAAS,EACTF,SAAS,EACTK,QAAQ,EACRC,QAAQ,CACR,CACAmB,IAAI,CACJ,UAACC,MAAM;MAAA,OAAKA,MAAM;IAAA,GAClB,UAACC,KAAK,EAAK;MACV;MACA,IAAI,EAAEA,KAAK,YAAYC,wBAAiB,CAAC,EAAE;QAC1C,IAAI7B,OAAO,EAAE;UACZA,OAAO,CAAC4B,KAAK,EAAE;YACdE,IAAI,EAAGjB,QAAQ,CAACkB,QAAQ;YACxBC,GAAG,EAAI,IAAAC,0BAAc,EAACpB,QAAQ,CAAC;YAC/B;YACA;YACA;YACA;YACAqB,QAAQ,oBAACC,EAAE,EAAE;cACZ;cACA,MAAM,IAAIN,wBAAiB,CAACM,EAAE,CAAC;YAChC,CAAC;YACD7B,QAAQ,EAARA,QAAQ;YACRC,QAAQ,EAARA,QAAQ;YACRR,MAAM,EAANA;UACD,CAAC,CAAC;QACH;MACD;MACA,MAAM6B,KAAK;IACZ,CAAC,CACD;EACF,CAAC;AACF;AAEA,SAAShB,YAAY,CAACwB,KAAK,EAAE;EAC5B,IAAMrC,MAAM,GAAG,OAAOS,MAAM,KAAK,WAAW;EAC5C,OAAO;IACNK,QAAQ,EAAE,IAAAwB,kCAA2B,EAACD,KAAK,CAAC;IAC5CtB,gBAAgB,EAAGf,MAAM,IAAI,CAACS,MAAM,CAAC8B,0CAA0C,GAAIpB,SAAS,GAAG,IAAAqB,mCAA4B,EAACH,KAAK;EAClI,CAAC;AACF"}