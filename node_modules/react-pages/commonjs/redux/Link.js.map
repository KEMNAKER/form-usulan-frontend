{"version":3,"file":"Link.js","names":["BaseLink","ref","Component","as","to","match","activeClassName","activeStyle","activePropName","router","exact","props","onClick","target","onClick_","useCallback","event","defaultPrevented","metaKey","altKey","ctrlKey","shiftKey","button","preventDefault","push","href","createHref","childrenIsFunction","children","toLocation","createLocation","active","isActive","className","style","React","createElement","forwardRef","propTypes","PropTypes","elementType","isRequired","oneOfType","string","object","bool","func","node","defaultProps","Link_","withRouter","displayName","Link","instantBack","rest","onClickHandler","markImmediateNavigationAsInstantBack"],"sources":["../../lib/redux/Link.js"],"sourcesContent":["import React, { useCallback } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { withRouter } from '@catamphetamine/found';\r\n\r\nimport { markImmediateNavigationAsInstantBack } from './client/instantNavigation.js'\r\n\r\n// `found`'s `src/BaseLink.js` doesn't have a `.focus()` method\r\n// and doesn't forward `ref` which prevents it from being\r\n// focusable programmatically.\r\n//\r\n//https://github.com/4Catalyzer/found/blob/master/src/Link.js\r\n// https://github.com/4Catalyzer/found/blob/master/src/BaseLink.js\r\n//\r\n// Therefore, copy-pasted it here and added `React.forwardRef()`.\r\n//\r\nfunction BaseLink({\r\n  as: Component,\r\n  to,\r\n  match,\r\n  activeClassName,\r\n  activeStyle,\r\n  activePropName,\r\n  router,\r\n  exact,\r\n  ...props\r\n}, ref) {\r\n\tconst { onClick, target } = props\r\n\r\n  const onClick_ = useCallback((event) => {\r\n    if (onClick) {\r\n      onClick(event)\r\n    }\r\n\r\n    // Don't do anything if the user's onClick handler prevented default.\r\n    // Otherwise, let the browser handle the link with the computed href if the\r\n    // event wasn't an unmodified left click, or if the link has a target other\r\n    // than _self.\r\n    if (\r\n      event.defaultPrevented ||\r\n      event.metaKey ||\r\n      event.altKey ||\r\n      event.ctrlKey ||\r\n      event.shiftKey ||\r\n      event.button !== 0 ||\r\n      (target && target !== '_self')\r\n    ) {\r\n      return\r\n    }\r\n\r\n    event.preventDefault()\r\n\r\n    // FIXME: When clicking on a link to the same location in the browser, the\r\n    // actual becomes a replace rather than a push. We may want the same\r\n    // handling â€“ perhaps implemented in the Farce protocol.\r\n    router.push(to)\r\n  }, [\r\n  \tonClick,\r\n  \ttarget,\r\n  \tto,\r\n  \trouter\r\n  ])\r\n\r\n  const href = router.createHref(to)\r\n  const childrenIsFunction = typeof props.children === 'function'\r\n\r\n  if (\r\n    childrenIsFunction ||\r\n    activeClassName ||\r\n    activeStyle ||\r\n    activePropName\r\n  ) {\r\n    const toLocation = router.createLocation(to)\r\n    const active = router.isActive(match, toLocation, { exact })\r\n\r\n    if (childrenIsFunction) {\r\n      return props.children({ href, active, onClick: this.onClick })\r\n    }\r\n\r\n    if (active) {\r\n      if (activeClassName) {\r\n        props.className = props.className\r\n          ? `${props.className} ${activeClassName}`\r\n          : activeClassName\r\n      }\r\n\r\n      if (activeStyle) {\r\n        props.style = { ...props.style, ...activeStyle }\r\n      }\r\n    }\r\n\r\n    if (activePropName) {\r\n      props[activePropName] = active\r\n    }\r\n  }\r\n\r\n  return React.createElement(Component, {\r\n    ref,\r\n    ...props,\r\n    href,\r\n    onClick: onClick_\r\n  })\r\n}\r\n\r\nBaseLink = React.forwardRef(BaseLink)\r\n\r\nBaseLink.propTypes = {\r\n  as: PropTypes.elementType.isRequired,\r\n  to: PropTypes.oneOfType([PropTypes.string, PropTypes.object]).isRequired,\r\n  match: PropTypes.object.isRequired,\r\n  activeClassName: PropTypes.string,\r\n  activeStyle: PropTypes.object,\r\n  activePropName: PropTypes.string,\r\n  router: PropTypes.object.isRequired,\r\n  exact: PropTypes.bool.isRequired,\r\n  target: PropTypes.string,\r\n  onClick: PropTypes.func,\r\n  children: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\r\n}\r\n\r\nBaseLink.defaultProps = {\r\n  as: 'a',\r\n  exact: false\r\n}\r\n\r\nconst Link_ = withRouter(BaseLink);\r\nLink_.displayName = 'Link';\r\n\r\nlet Link = function({\r\n\tinstantBack,\r\n\tonClick,\r\n\t...rest\r\n}, ref) {\r\n\tconst onClickHandler = useCallback((event) => {\r\n\t\tif (onClick) {\r\n\t\t\tonClick(event)\r\n\t\t}\r\n\t\tif (event.defaultPrevented) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tmarkImmediateNavigationAsInstantBack(instantBack)\r\n\t}, [\r\n\t\tinstantBack,\r\n\t\tonClick\r\n\t])\r\n\r\n\treturn React.createElement(\r\n    Link_,\r\n    {\r\n      ref,\r\n      ...rest,\r\n      onClick: onClickHandler\r\n    }\r\n\t)\r\n}\r\n\r\nLink = React.forwardRef(Link)\r\n\r\nLink.propTypes = {\r\n\tinstantBack: PropTypes.bool,\r\n\tonClick: PropTypes.func\r\n}\r\n\r\nexport default Link"],"mappings":";;;;;;;AAAA;AACA;AACA;AAEA;AAAoF;EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,QAAQ,OAUdC,GAAG,EAAE;EAAA,IATFC,SAAS,QAAbC,EAAE;IACFC,EAAE,QAAFA,EAAE;IACFC,KAAK,QAALA,KAAK;IACLC,eAAe,QAAfA,eAAe;IACfC,WAAW,QAAXA,WAAW;IACXC,cAAc,QAAdA,cAAc;IACdC,MAAM,QAANA,MAAM;IACNC,KAAK,QAALA,KAAK;IACFC,KAAK;EAET,IAAQC,OAAO,GAAaD,KAAK,CAAzBC,OAAO;IAAEC,MAAM,GAAKF,KAAK,CAAhBE,MAAM;EAEtB,IAAMC,QAAQ,GAAG,IAAAC,kBAAW,EAAC,UAACC,KAAK,EAAK;IACtC,IAAIJ,OAAO,EAAE;MACXA,OAAO,CAACI,KAAK,CAAC;IAChB;;IAEA;IACA;IACA;IACA;IACA,IACEA,KAAK,CAACC,gBAAgB,IACtBD,KAAK,CAACE,OAAO,IACbF,KAAK,CAACG,MAAM,IACZH,KAAK,CAACI,OAAO,IACbJ,KAAK,CAACK,QAAQ,IACdL,KAAK,CAACM,MAAM,KAAK,CAAC,IACjBT,MAAM,IAAIA,MAAM,KAAK,OAAQ,EAC9B;MACA;IACF;IAEAG,KAAK,CAACO,cAAc,EAAE;;IAEtB;IACA;IACA;IACAd,MAAM,CAACe,IAAI,CAACpB,EAAE,CAAC;EACjB,CAAC,EAAE,CACFQ,OAAO,EACPC,MAAM,EACNT,EAAE,EACFK,MAAM,CACN,CAAC;EAEF,IAAMgB,IAAI,GAAGhB,MAAM,CAACiB,UAAU,CAACtB,EAAE,CAAC;EAClC,IAAMuB,kBAAkB,GAAG,OAAOhB,KAAK,CAACiB,QAAQ,KAAK,UAAU;EAE/D,IACED,kBAAkB,IAClBrB,eAAe,IACfC,WAAW,IACXC,cAAc,EACd;IACA,IAAMqB,UAAU,GAAGpB,MAAM,CAACqB,cAAc,CAAC1B,EAAE,CAAC;IAC5C,IAAM2B,MAAM,GAAGtB,MAAM,CAACuB,QAAQ,CAAC3B,KAAK,EAAEwB,UAAU,EAAE;MAAEnB,KAAK,EAALA;IAAM,CAAC,CAAC;IAE5D,IAAIiB,kBAAkB,EAAE;MACtB,OAAOhB,KAAK,CAACiB,QAAQ,CAAC;QAAEH,IAAI,EAAJA,IAAI;QAAEM,MAAM,EAANA,MAAM;QAAEnB,OAAO,EAAE,IAAI,CAACA;MAAQ,CAAC,CAAC;IAChE;IAEA,IAAImB,MAAM,EAAE;MACV,IAAIzB,eAAe,EAAE;QACnBK,KAAK,CAACsB,SAAS,GAAGtB,KAAK,CAACsB,SAAS,aAC1BtB,KAAK,CAACsB,SAAS,cAAI3B,eAAe,IACrCA,eAAe;MACrB;MAEA,IAAIC,WAAW,EAAE;QACfI,KAAK,CAACuB,KAAK,mCAAQvB,KAAK,CAACuB,KAAK,GAAK3B,WAAW,CAAE;MAClD;IACF;IAEA,IAAIC,cAAc,EAAE;MAClBG,KAAK,CAACH,cAAc,CAAC,GAAGuB,MAAM;IAChC;EACF;EAEA,OAAOI,iBAAK,CAACC,aAAa,CAAClC,SAAS;IAClCD,GAAG,EAAHA;EAAG,GACAU,KAAK;IACRc,IAAI,EAAJA,IAAI;IACJb,OAAO,EAAEE;EAAQ,GACjB;AACJ;AAEAd,QAAQ,GAAGmC,iBAAK,CAACE,UAAU,CAACrC,QAAQ,CAAC;AAErCA,QAAQ,CAACsC,SAAS,GAAG;EACnBnC,EAAE,EAAEoC,qBAAS,CAACC,WAAW,CAACC,UAAU;EACpCrC,EAAE,EAAEmC,qBAAS,CAACG,SAAS,CAAC,CAACH,qBAAS,CAACI,MAAM,EAAEJ,qBAAS,CAACK,MAAM,CAAC,CAAC,CAACH,UAAU;EACxEpC,KAAK,EAAEkC,qBAAS,CAACK,MAAM,CAACH,UAAU;EAClCnC,eAAe,EAAEiC,qBAAS,CAACI,MAAM;EACjCpC,WAAW,EAAEgC,qBAAS,CAACK,MAAM;EAC7BpC,cAAc,EAAE+B,qBAAS,CAACI,MAAM;EAChClC,MAAM,EAAE8B,qBAAS,CAACK,MAAM,CAACH,UAAU;EACnC/B,KAAK,EAAE6B,qBAAS,CAACM,IAAI,CAACJ,UAAU;EAChC5B,MAAM,EAAE0B,qBAAS,CAACI,MAAM;EACxB/B,OAAO,EAAE2B,qBAAS,CAACO,IAAI;EACvBlB,QAAQ,EAAEW,qBAAS,CAACG,SAAS,CAAC,CAACH,qBAAS,CAACQ,IAAI,EAAER,qBAAS,CAACO,IAAI,CAAC;AAChE,CAAC;AAED9C,QAAQ,CAACgD,YAAY,GAAG;EACtB7C,EAAE,EAAE,GAAG;EACPO,KAAK,EAAE;AACT,CAAC;AAED,IAAMuC,KAAK,GAAG,IAAAC,iBAAU,EAAClD,QAAQ,CAAC;AAClCiD,KAAK,CAACE,WAAW,GAAG,MAAM;AAE1B,IAAIC,IAAI,GAAG,qBAIRnD,GAAG,EAAE;EAAA,IAHPoD,WAAW,SAAXA,WAAW;IACXzC,OAAO,SAAPA,OAAO;IACJ0C,IAAI;EAEP,IAAMC,cAAc,GAAG,IAAAxC,kBAAW,EAAC,UAACC,KAAK,EAAK;IAC7C,IAAIJ,OAAO,EAAE;MACZA,OAAO,CAACI,KAAK,CAAC;IACf;IACA,IAAIA,KAAK,CAACC,gBAAgB,EAAE;MAC3B;IACD;IACA,IAAAuC,uDAAoC,EAACH,WAAW,CAAC;EAClD,CAAC,EAAE,CACFA,WAAW,EACXzC,OAAO,CACP,CAAC;EAEF,OAAOuB,iBAAK,CAACC,aAAa,CACvBa,KAAK;IAEHhD,GAAG,EAAHA;EAAG,GACAqD,IAAI;IACP1C,OAAO,EAAE2C;EAAc,GAE3B;AACF,CAAC;AAEDH,IAAI,GAAGjB,iBAAK,CAACE,UAAU,CAACe,IAAI,CAAC;AAE7BA,IAAI,CAACd,SAAS,GAAG;EAChBe,WAAW,EAAEd,qBAAS,CAACM,IAAI;EAC3BjC,OAAO,EAAE2B,qBAAS,CAACO;AACpB,CAAC;AAAA,eAEcM,IAAI;AAAA"}